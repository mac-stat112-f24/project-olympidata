---
title: "Shooting & Rowing"
subtitle: "project olympidata"
author: "Han Sun"
output: 
  html_document:
    toc: true
    toc_float: true
---

```{r include = FALSE}
palette("Okabe-Ito")
scale_colour_discrete <- function(...) scale_colour_manual(values = palette())
scale_fill_discrete   <- function(...) scale_fill_manual(values = palette())

knitr::opts_chunk$set(
  collapse = TRUE, 
  warning = FALSE,
  message = FALSE,
  fig.height = 2.75, 
  fig.width = 4.25,
  fig.env='figure',
  fig.pos = 'h',
  fig.align = 'center')
```

# Import Data
```{r}
olympics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-08-06/olympics.csv')
```

# Packages
```{r}
library(plotly)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidymodels)
library(glmnet)
library(tidyr)
```


# Generating Data
## filter by sports
```{r}
shooting <- olympics %>%
  filter(sport == "Shooting")%>%
  drop_na()
shooting

rowing<- olympics %>%
  filter(sport == "Rowing")%>%
  drop_na()
rowing
```

## divide by sex
```{r}
shooting_M <- shooting %>%
  filter(sex == "M")
shooting_F <- shooting %>%
  filter(sex == "F")

rowing_M <- rowing %>%
  filter(sex == "M")
rowing_F <- rowing %>%
  filter(sex == "F")
```

# Primary Studies For Events
## Shooting
### male
```{r}
shooting_eventM <- shooting_M %>%
  group_by(event)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(shooting_M, aes(x = event))+
  geom_bar()
ggplot(shooting_eventM, aes(x = event, y = avg_h))+
  geom_point()
ggplot(shooting_eventM, aes(x = event, y = avg_w))+
  geom_point()
ggplot(shooting_eventM, aes(x = event, y = avg_a))+
  geom_point()
```
### female
```{r}
shooting_eventF <- shooting_F %>%
  group_by(event)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(shooting_F, aes(x = event))+
  geom_bar()
ggplot(shooting_eventF, aes(x = event, y = avg_h))+
  geom_point()
ggplot(shooting_eventF, aes(x = event, y = avg_w))+
  geom_point()
ggplot(shooting_eventF, aes(x = event, y = avg_a))+
  geom_point()
```

For shooting, from the plots, both average height, weight, and age varied a lot for the prized athletes for both gender. We should pay attention to how event will affect our outcomes, for example, if we are study about year, we have to get rid of the effects from event. 

## Rowing
### male
```{r}
rowing_eventM <- rowing_M %>%
  group_by(event)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(rowing_M, aes(x = event))+
  geom_bar()
ggplot(rowing_eventM, aes(x = event, y = avg_h))+
  geom_point()
ggplot(rowing_eventM, aes(x = event, y = avg_w))+
  geom_point()
ggplot(rowing_eventM, aes(x = event, y = avg_a))+
  geom_point()
```

### female
```{r}
rowing_eventF <- rowing_F %>%
  group_by(event)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(rowing_F, aes(x = event))+
  geom_bar()
ggplot(rowing_eventF, aes(x = event, y = avg_h))+
  geom_point()
ggplot(rowing_eventF, aes(x = event, y = avg_w))+
  geom_point()
ggplot(rowing_eventF, aes(x = event, y = avg_a))+
  geom_point()
```

For rowing, from the plot, both average height and weight varied a lot for the prized athletes for both gender, while the average age is in a much smaller range, we should pay more attention on the effect from event for average height and weight.


# Primary Studies For Year
## shooting
### male
```{r}
shooting_yearM <- shooting_M %>%
  group_by(year)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(shooting_M, aes(x = year))+
  geom_bar()
ggplot(shooting_yearM, aes(x = year, y = avg_h))+
  geom_point()
ggplot(shooting_yearM, aes(x = year, y = avg_w))+
  geom_point()
ggplot(shooting_yearM, aes(x = year, y = avg_a))+
  geom_point()
```

### female
```{r}
shooting_yearF <- shooting_F %>%
  group_by(year)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(shooting_F, aes(x = year))+
  geom_bar()
ggplot(shooting_yearF, aes(x = year, y = avg_h))+
  geom_point()
ggplot(shooting_yearF, aes(x = year, y = avg_w))+
  geom_point()
ggplot(shooting_yearF, aes(x = year, y = avg_a))+
  geom_point()
```

For shooting, most data points are in a small range. In very early years, some data was very different. However, there are few data points in early years, so the effect from year isn't very obvious for avg_h, avg_w and avg_a.


## Rowing
### male
```{r}
rowing_yearM <- rowing_M %>%
  group_by(year)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(rowing_M, aes(x = year))+
  geom_bar()
ggplot(rowing_yearM, aes(x = year, y = avg_h))+
  geom_point()
ggplot(rowing_yearM, aes(x = year, y = avg_w))+
  geom_point()
ggplot(rowing_yearM, aes(x = year, y = avg_a))+
  geom_point()
```

### female
```{r}
rowing_yearF <- rowing_F %>%
  group_by(year)%>%
  summarize(avg_h = mean(height),
            avg_w = mean(weight),
            avg_a = mean(age),
            count = n())
ggplot(rowing_F, aes(x = year))+
  geom_bar()
ggplot(rowing_yearF, aes(x = year, y = avg_h))+
  geom_point()
ggplot(rowing_yearF, aes(x = year, y = avg_w))+
  geom_point()
ggplot(rowing_yearF, aes(x = year, y = avg_a))+
  geom_point()
```

For rowing, especially for male, both average weight, height, and age have a increasing by year, for female, the trend is not that obvious but still exist. It might be a good point to have more studies.



# Fitting models
## shooting
### male
#### height
```{r}
shooting_M<- shooting_M %>%
  mutate(event = str_replace(event, "Shooting Men's", ""))%>%
  mutate(event = str_replace_all(event, " ", ""))%>%
  mutate(event = str_replace(event, ",", ""))%>%
  mutate(event = str_wrap(event, width = 6))
ggplot(shooting_M, aes(x = year, y = height))+
  geom_point()+
  geom_smooth(method = "lm")+
  facet_wrap(~ event)

ggplot(shooting_M, aes(x = year, y = weight))+
  geom_point()+
  geom_smooth(method = "lm")+
  facet_wrap(~ event)

ggplot(shooting_M, aes(x = year, y = age))+
  geom_point()+
  geom_smooth(method = "lm")+
  facet_wrap(~ event)
```
For every event individually, year doesn't have much effect. The relation showed in previous part might caused by that some events only hold in specific duration, so we might only need a boxplot for events.


```{r}
ggplot(shooting_M, aes(x = event, y = height))+
  geom_boxplot()
ggplot(shooting_M, aes(x = event, y = weight))+
  geom_boxplot()
ggplot(shooting_M, aes(x = event, y = age))+
  geom_boxplot()
```

From the boxplot, most male shooting athletes are around 170-180cm despite their event and year; the event trap team will require higher weight than other event, which around 90-115kg, while most other events are around 70-90kg; most events have wide age range from about 25-35, while events including running like running target 50 meters, will have smaller ranges from 20-30.

### female
 
```{r}
ggplot(shooting_F, aes(x = year, y = height))+
  geom_point()+
  geom_smooth(method = "lm")+
  facet_wrap(~ event)
```




